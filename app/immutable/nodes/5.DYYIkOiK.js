import{t as i,a,c as pe,b as M}from"../chunks/i3BjmpM2.js";import{Z as Pe,a3 as X,a4 as ce,a5 as _e,O as we,$ as Re,a2 as z,R as C,a0 as _,a6 as V,j as e,a7 as De,a1 as t,_ as F}from"../chunks/Ddu1Jl4_.js";import{d as Oe,s as I}from"../chunks/ByWB01Zr.js";import{i as O}from"../chunks/B0eBhlmk.js";import{e as N,i as $e}from"../chunks/DOu1D6ee.js";import{R as je,C as Le,I as Ue,D as Y,b as Te,T as ue}from"../chunks/BnQun7ys.js";import{o as Ce}from"../chunks/CICj1xN9.js";import"../chunks/Q0CN05tj.js";import"../chunks/nbzItWDT.js";import{s,C as Ie}from"../chunks/CwSdEVOQ.js";const Ne="always",Ee=!1,Me=!1,Ve=!0;async function Fe({url:k}){let r={};const v=k.searchParams.has("elfURLData"),ee=localStorage.getItem("lastOpenElfURL"),R=v?decodeURIComponent(k.searchParams.get("elfURLData")):ee;if(R){const h=await(await fetch(R)).json();localStorage.lastOpenElfURL=R,localStorage.elfStorageDate=new Date().toISOString(),r.symbols=h,console.log("Loaded elf data"),r.elfDataProvided=!0}else console.log("Loaded elf data",R,Object.keys(symbols.symbols).length);if(k.searchParams.has("selected_version")){const n=k.searchParams.get("selected_version");localStorage.selected_version=n,r.selected_version=n}else localStorage.getItem("selected_version")&&(r.selected_version=localStorage.getItem("selected_version"));if(k.searchParams.has("symbols.selected_versions_to_compare")){const n=k.searchParams.get("symbols.selected_versions_to_compare");localStorage.selected_versions_to_compare=n,r.selected_versions_to_compare=n}else localStorage.getItem("selected_versions_to_compare")&&(r.selected_versions_to_compare=localStorage.getItem("selected_versions_to_compare"));return r}const ua=Object.freeze(Object.defineProperty({__proto__:null,csr:Ve,load:Fe,prerender:Ee,ssr:Me,trailingSlash:Ne},Symbol.toStringTag,{value:"Module"}));var Je=i("<option> </option>"),We=i("Select a version of the .elf you want to see: <!>",1),Ae=i('<label for="elfinput">Upload a puncover .json file:</label> <input accept="*/json" id="elfinput" name="elfinput" type="file">',1),Ze=i("<h3>Select a version to browse elf symbols :)</h3>"),qe=(k,r,v)=>e(r).toggleSort(e(v).id),Be=i('<span class="ml-2"><!></span>'),Ge=i('<th> <button class="flex items-center"><!></button></th>'),He=i("<td> </td>"),Ke=i("<tr></tr>"),Qe=i("<thead><tr></tr></thead> <tbody></tbody>",1),Xe=(k,r,v)=>e(r).toggleSort(e(v).id),Ye=i('<span class="ml-2"><!></span>'),ea=i('<th> <button class="flex items-center"><!></button></th>'),aa=i("<td> </td>"),ta=i("<tr></tr>"),sa=i("<thead><tr></tr></thead> <tbody></tbody>",1),ra=i("<h3> </h3> <!> <h3> </h3> <!>",1),oa=i('<div class="container" id="content"><!> <hr> <!></div>');function ya(k,r){Pe(r,!0),s.symbols=r.data.symbols,s.selected_version=r.data.selected_version,s.selected_versions_to_compare=r.data.selected_versions_to_compare,s.elfDataProvided=r.data.elfDataProvided;let v=X(void 0),ee=ce(()=>Object.keys(s.symbols)),R=X(_e({})),J=X(_e([])),W=X(_e([])),n=ce(()=>new Y({pageSize:9999,data:e(J),columns:[{id:"name",key:"display_name",name:"Name"},{id:"remark",key:"remark",name:"Remarks"},{id:"size",key:"size",name:"Code size"},{id:"stack_size",key:"stack_size",name:"Stack size"}]})),h=ce(()=>new Y({pageSize:999999,data:e(W),columns:[{id:"name",key:"display_name",name:"Name"},{id:"remark",key:"remark",name:"Remarks"},{id:"size",key:"size",name:"Static size"}]})),ye=d=>{let m={};for(const b of d)b.remark=b.called_from_other_file?"x-module":"",b.newSymbols=!1,b.deletedSymbols=!1,m[b.file+b.display_name]=b;return m},be=d=>Object.values(d).filter(m=>m.type==="function"),he=d=>Object.values(d).filter(m=>m.type==="variable");const ve=()=>{V(R,ye(s.symbols[s.selected_version].symbols),!0),V(J,be(e(R)),!0),V(W,he(e(R)),!0),V(n,new Y({pageSize:e(J).length,data:e(J),columns:[{id:"name",key:"display_name",name:"Name"},{id:"remark",key:"remark",name:"Remarks"},{id:"size",key:"size",name:"Code size"},{id:"stack_size",key:"stack_size",name:"Stack size"}]}),!0),V(h,new Y({pageSize:e(W).length,data:e(W),columns:[{id:"name",key:"name",name:"Name"},{id:"remark",key:"remark",name:"Remarks"},{id:"size",key:"size",name:"Static size"}]}),!0)},ge=()=>{localStorage.selected_version=s.selected_version,ve()};we(()=>{if(e(v)){console.log("files "+e(v));const d=e(v)[0];if(!d){console.log("No file selected. Please choose a file.","error");return}if(!(d.type.endsWith("JSON")||d.type.endsWith("json"))){console.log(d.type+"Unsupported file type. Please select a text file.","error");return}const m=new FileReader;m.onload=()=>{s.symbols=JSON.parse(m.result)},m.onerror=()=>{showMessage("Error reading the file. Please try again.","error")},m.readAsText(d)}}),Ce(async()=>{Object.keys(s.symbols).length==0?console.log("No ELF data URL passed or stored, please upload it as a file then :)"):s.selected_version&&s.selected_versions_to_compare?ve():console.log("ELF loaded, please select which version to show :)")});var ae=oa(),me=_(ae);je(me,{children:(d,m)=>{Le(d,{children:(b,fe)=>{De();var H=We(),te=z(C(H));Ue(te,{type:"select",get value(){return s.selected_version},set value(x){s.selected_version=x},$$events:{change:ge},children:(x,A)=>{var E=pe(),Z=C(E);N(Z,17,()=>e(ee),$e,(D,P)=>{var w=Je(),K={},Q=_(w,!0);t(w),F(()=>{K!==(K=e(P))&&(w.value=(w.__value=e(P))==null?"":e(P)),I(Q,e(P))}),a(D,w)}),a(x,E)},$$slots:{default:!0}}),a(b,H)},$$slots:{default:!0}})},$$slots:{default:!0}});var Se=z(me,4);Ie(Se,{fluid:!0,children:(d,m)=>{var b=pe(),fe=C(b);{var H=x=>{var A=Ae(),E=z(C(A),2);Te(E,()=>e(v),Z=>V(v,Z)),a(x,A)},te=(x,A)=>{{var E=D=>{var P=Ze();a(D,P)},Z=D=>{var P=ra(),w=C(P),K=_(w);t(w);var Q=z(w,2);ue(Q,{children:(re,ze)=>{var q=Qe(),$=C(q),B=_($);N(B,21,()=>e(n).columns,o=>o.name,(o,l)=>{var c=Ge(),f=_(c),p=z(f);p.__click=[qe,n,l];var g=_(p);{var j=S=>{var L=Be(),oe=_(L);{var le=u=>{var U=M("↑");a(u,U)},ne=(u,U)=>{{var ie=y=>{var T=M("↓");a(y,T)},de=y=>{var T=M("↕");a(y,T)};O(u,y=>{e(n).getSortState(e(l).id)==="desc"?y(ie):y(de,!1)},U)}};O(oe,u=>{e(n).getSortState(e(l).id)==="asc"?u(le):u(ne,!1)})}t(L),a(S,L)};O(g,S=>{e(n).isSortable(e(l).id)&&S(j)})}t(p),t(c),F(S=>{I(f,`${e(l).name??""} `),p.disabled=S},[()=>!e(n).isSortable(e(l).id)]),a(o,c)}),t(B),t($);var G=z($,2);N(G,21,()=>e(n).rows,o=>o.file+o.name,(o,l)=>{var c=Ke();N(c,21,()=>e(n).columns,f=>f.name,(f,p)=>{var g=He(),j=_(g,!0);t(g),F(()=>I(j,e(l)[e(p).key])),a(f,g)}),t(c),a(o,c)}),t(G),a(re,q)},$$slots:{default:!0}});var se=z(Q,2),ke=_(se);t(se);var xe=z(se,2);ue(xe,{children:(re,ze)=>{var q=sa(),$=C(q),B=_($);N(B,21,()=>e(h).columns,o=>o.name,(o,l)=>{var c=ea(),f=_(c),p=z(f);p.__click=[Xe,h,l];var g=_(p);{var j=S=>{var L=Ye(),oe=_(L);{var le=u=>{var U=M("↑");a(u,U)},ne=(u,U)=>{{var ie=y=>{var T=M("↓");a(y,T)},de=y=>{var T=M("↕");a(y,T)};O(u,y=>{e(h).getSortState(e(l).id)==="desc"?y(ie):y(de,!1)},U)}};O(oe,u=>{e(h).getSortState(e(l).id)==="asc"?u(le):u(ne,!1)})}t(L),a(S,L)};O(g,S=>{e(h).isSortable(e(l).id)&&S(j)})}t(p),t(c),F(S=>{I(f,`${e(l).name??""} `),p.disabled=S},[()=>!e(h).isSortable(e(l).id)]),a(o,c)}),t(B),t($);var G=z($,2);N(G,21,()=>e(h).rows,o=>o.file+o.name,(o,l)=>{var c=ta();N(c,21,()=>e(h).columns,f=>f.name,(f,p)=>{var g=aa(),j=_(g,!0);t(g),F(()=>I(j,e(l)[e(p).key])),a(f,g)}),t(c),a(o,c)}),t(G),a(re,q)},$$slots:{default:!0}}),F(()=>{I(K,`Function symbols for ${s.selected_version??""}`),I(ke,`Variable symbols for ${s.selected_version??""}`)}),a(D,P)};O(x,D=>{s.selected_version?D(Z,!1):D(E)},A)}};O(fe,x=>{!s.elfDataProvided&&e(v)&&!e(v)[0]?x(H):x(te,!1)})}a(d,b)},$$slots:{default:!0}}),t(ae),a(k,ae),Re()}Oe(["click"]);export{ya as component,ua as universal};
